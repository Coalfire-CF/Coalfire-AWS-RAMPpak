- name: Populate service facts
  ansible.builtin.service_facts:

- name: Assert that Service is running
  ansible.builtin.assert:
    that:
      - "{{ ansible_facts.services[item + '.service']['state'] == 'running' }}"
    fail_msg: "State is {{ ansible_facts.services[item + '.service']['state'] }}"
    success_msg: "Service {{ item }} is running."
  loop: "{{ service_names }}"
